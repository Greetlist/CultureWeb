name: web_admin
on:
  push:
    paths-ignore:
      - 'web_admin/frontend/**'
      - 'web_front/**'
  pull_request:
      paths-ignore:
      - 'web_admin/frontend/**'
      - 'web_front/**'

jobs:
  Build-Test-Binary:
    runs-on: self-hosted
    steps:
    - uses: actions/checkout@v3
    - name: Down load go packages
      run: export GOPROXY=https://goproxy.io && go install github.com/swaggo/swag/cmd/swag@latest
    - name: Print some var
      run: |
        echo $GITHUB_ENV
        echo "SWAG_PATH=/home/greetlist/workspace/bin/" >> $GITHUB_ENV
        echo $GITHUB_ENV

    - name: Test var
      run: |
        echo "${{ env.SWAG_PATH }}" >> $GITHUB_PATH
        ${{ env.SWAG_PATH }}/swag -h
    - name: Build with make
      run: |
        export GITHUB_PATH=$GITHUB_PATH:/home/greetlist/workspace/bin
        cd web_admin/server/ && make -j4
